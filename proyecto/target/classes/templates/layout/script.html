<div th:fragment="script">
    <!-- jQuery  -->
    <script src="../../../../assets/js/jquery.min.js"></script>
    <script src="../../../../assets/js/bootstrap.bundle.min.js"></script>
    <script src="../../../../assets/js/modernizr.min.js"></script>
    <script src="../../../../assets/js/detect.js"></script>
    <script src="../../../../assets/js/fastclick.js"></script>
    <script src="../../../../assets/js/jquery.slimscroll.js"></script>
    <script src="../../../../assets/js/jquery.blockUI.js"></script>
    <script src="../../../../assets/js/waves.js"></script>
    <script src="../../../../assets/js/jquery.nicescroll.js"></script>
    <script src="../../../../assets/js/jquery.scrollTo.min.js"></script>

    <!-- skycons -->
    <script src="../../../../assets/plugins/skycons/skycons.min.js"></script>

    <!-- skycons -->
    <script src="../../../../assets/plugins/peity/jquery.peity.min.js"></script>

    <!--Morris Chart-->
    <script src="../../../../assets/plugins/morris/morris.min.js"></script>
    <script src="../../../../assets/plugins/raphael/raphael-min.js"></script>

    <!-- dashboard -->
    <script src="../../../../assets/pages/dashboard.js"></script>

    <!-- Required datatable js -->
    <script src="../../../../assets/plugins/datatables/jquery.dataTables.min.js"></script>
    <script src="../../../../assets/plugins/datatables/dataTables.bootstrap4.min.js"></script>
    <!-- Buttons examples -->
    <script src="../../../../assets/plugins/datatables/dataTables.buttons.min.js"></script>
    <script src="../../../../assets/plugins/datatables/buttons.bootstrap4.min.js"></script>
    <script src="../../../../assets/plugins/datatables/jszip.min.js"></script>
    <script src="../../../../assets/plugins/datatables/pdfmake.min.js"></script>
    <script src="../../../../assets/plugins/datatables/vfs_fonts.js"></script>
    <script src="../../../../assets/plugins/datatables/buttons.html5.min.js"></script>
    <script src="../../../../assets/plugins/datatables/buttons.print.min.js"></script>
    <script src="../../../../assets/plugins/datatables/buttons.colVis.min.js"></script>
    <!-- Responsive examples -->
    <script src="../../../../assets/plugins/datatables/dataTables.responsive.min.js"></script>
    <script src="../../../../assets/plugins/datatables/responsive.bootstrap4.min.js"></script>

    <!-- Datatable init js -->
    <script src="../../../../assets/pages/datatables.init.js"></script>

    <!-- Plugins js -->
    <script src="../../../../assets/plugins/bootstrap-colorpicker/js/bootstrap-colorpicker.min.js"></script>
    <script src="../../../../assets/plugins/bootstrap-datepicker/js/bootstrap-datepicker.min.js"></script>
    <script src="../../../../assets/plugins/bootstrap-maxlength/bootstrap-maxlength.min.js"></script>
    <script src="../../../../assets/plugins/bootstrap-touchspin/js/jquery.bootstrap-touchspin.min.js"></script>
    <!-- App js -->
    <script src="../../../../assets/js/app.js"></script>
    <script src="../../../../assets/js/fragment.js"></script>

    <!-- INICIO TODOS ESTOS ARCHIVOS SON PARA SELECT BUSCADOR-->
    <script src="../../../../vendors/choices/choices.min.js"></script>
    <script src="../../../../vendors/anchorjs/anchor.min.js"></script><!--esto-->
    <script src="../../../../vendors/lodash/lodash.min.js"></script><!--esto-->
    <script src="../../../../assets/js/theme.js"></script>
    <!-- FIN TODOS ESTOS ARCHIVOS SON PARA SELECT BUSCADOR-->
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

    <!-- SWEET-ALERT JS -->
    <script src="../../../../assets/plugins/sweet-alert2/sweetalert2.min.js"></script>
    <!-- JS de Tagify -->
    <script src="https://cdn.jsdelivr.net/npm/@yaireo/tagify@4.6.0/dist/tagify.min.js"></script>

    <script>
        (function () {
            let $contenido = $("#contenido");
            let $currentActive = null;

            // Click delegado para cualquier item con menu-ajax
            $(document).on('click', 'a.menu-ajax', function (e) {
                e.preventDefault();

                const url = $(this).data('url');
                if (!url) return;

                // Activo visual: sobre el <li> contenedor
                if ($currentActive) $currentActive.removeClass('active');
                $currentActive = $(this).closest('li');
                $currentActive.addClass('active');

                cargarContenido(url);
            });

            // Opción: cargar por defecto algo al entrar, si lo deseas
            $(document).ready(function () {
                // ejemplo: al iniciar sesión y solo si hay contenedor
                if (document.body.dataset.ctx === "A" && $contenido.length) {
                    // cargarContenido("/vista-administrador"); // tu lógica anterior
                }
            });

            function cargarContenido(url) {
                // Spinner
                $("#contenido").html(
                    '<div class="d-flex justify-content-center">' +
                    '<div class="spinner-border m-5 text-secondary" role="status">' +
                    '<span class="visually-hidden">Loading...</span>' +
                    '</div>' +
                    '</div>'
                );

                // Carga real del fragmento
                $.ajax({
                    url: url,
                    method: "GET",
                    success: function (data) {
                        $("#contenido").html(data);
                    },
                    error: function (xhr) {
                        if (xhr.status === 401) {
                            Swal.fire({
                                title: 'Sesión expirada',
                                text: 'Tu sesión ha expirado. Por favor, inicia sesión nuevamente.',
                                icon: 'warning',
                                confirmButtonText: 'Ir al login'
                            }).then(() => window.location.href = '/');
                            return;
                        }
                        console.error('Error en la solicitud:', xhr);
                        $("#contenido").html('<div class="alert alert-danger m-3">Error al cargar la vista.</div>');
                    }
                });
            }
        })();
    </script>
</div>